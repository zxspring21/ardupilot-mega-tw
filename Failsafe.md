== APM 失效保護功能 ==

APM 有一個有限的失效保護功能，運行在第二級的 PPM 編碼處理器上，上面設計了2種功用：

  1. 甚至 APM 的主要處理器/代碼無法正確的運作，允許用戶重新手動遙控控制。它只能使用於飛機及某些傳統直升機。在多軸直升機上，在沒有控制板的情況下是無法手動飛行，控制這個功能(Input 8)的通道是無法被使用的。
  1. 完整偵測遙控信號的丟失(如果 RC 接收機能夠產生一種可預測信號丟失的行為)並且啟動已定義的自動模式回應，例如回到 home 的位置。一些遙控設備可以做到這一點，而有些則不行(如果你的遙控器有支援這個功能，請見下方祥細說明)。

下面是失效保護\*沒辦法做到的**:**

  1. 偵測更多更多的個別 RC 通道，如果發生故障或斷開連接
  1. 偵測飛的太遠或墜落地面
  1. 偵測自動駕駛的硬體失效保護，例如低電壓保護或飛機空中重置
  1. 偵測 APM 軟體運行不正常
  1. 偵測飛機的其他問題，如馬達故障或電池沒電的狀況(雖然後者可以通過主要的代碼設置，如果你有正確的安裝電壓/電流傳感器)
  1. 以其他方式從設置停止或者飛行錯誤


---


## 失效保護的祥細設置說明 ##

共有三種完全不同的失效保護模式:

**1.-接收機失效保護**: 該失效保護工作在遙控接收器端 (並非所有的遙控發射/接收系統都有該功能)。它與 ArduPilot Mega (APM)的 PPM 編碼器毫無關係。在此模式下用戶需要預先配置舵機的"失效保護"輸出。該配置必須將 "ArdupilotMega 復用器" 的控制權交給自駕儀 (復用器切換到 Atmega1280/2560)，同時將用戶定義的"通道模式"切換到"自動返航"(I will explain this later), 這樣一旦失去遙控信號，飛機將安全地返回。注意某些 72Mhz 遙控系統沒有內建的"接收失效保護"。如果是這樣的話你必須依靠下面所述的"PPM油門失效保護"功能。

5/29/2011 更新: 最新的程式有兩種失效保護動作: 一個是短時間的失效保護(失去訊號超過 1.5 秒)另一個是長時間失效保護(失去訊號超過20 秒)。

[這裡](http://diydrones.com/profiles/blogs/spektrum-dx8-and-ar8000-failsafe-setup)有一個使用SPEKTRUM 無線遙控設置失效保護的範例。

你可以選擇自動及停懸模式(透過設定組態)但它們將會被是否開啟失效保護所影響。如果是這樣就會把模式換至 RTL。對於較低的模式(透過 FBW-B 的手冊)這種模式會為了短時間失效保護會切換至繞圈模式，長時間失效保護會切換至 RTL。如果訊號已經回復短時間失效保護會回到原來的模式，但長時間失效保護則會回復至 RTL 直到你變更為其他模式。


**2.-PPM油門失效保護**: 油門失效保護是 APM 內建 "PPM 編碼器"的一個可選功能。PPM 編碼器的頭文件中可以定義編碼器監視的輸入通道和油門值。如果定義的通道達到預定義的值，那麼將出發"失效保護"功能。(這通常發生在 72Mhz 遙控器超出遙控距離或者關閉時。）觸發失效保護後，PPM 編碼器會把所有的舵機輸出信號設為用戶預定義的位置。這些"預定義的舵機位置"在 PPM 編碼器源代碼的同一個頭文件中。這就允許你將自駕儀設為正確的模式並安全返航（復用器切換到自駕儀，飛行模式設為自動返航).... 但是這需要你有基本的編程技能，需要安裝 WINAVR/AVR STUDIO 還需要一個 AVR 燒錄器... 我正在想辦法弄出一個簡單的解決方案來... 同時，最簡單的方法是改用 2.4Ghz 遙控系統。去買一個吧 ;-)

**3.-PPM復用器失效保護**: 使用任意一個定義的輸入通道（在 PPM 編碼器源代碼的同一個頭文件裡），該特性可以讓四個主要的輸入通道(Ch1, 2, 3 and 4)"硬"連接到輸出通道(Ch1, 2, 3 and 4)上。這在開發階段比較有用，因為自駕儀可能卡住或者崩潰（它在處理器當機的情況下也能工作）。這個功能對直升機和四旋翼沒有用處，因為飛行需要的混控是在自駕儀內完成的，所以小心一點。無論如何，那個頭文件允許你關閉該特性，這也可以釋放一個輸入通道可以用來做其他的事情....

![http://wiki.ardupilot-mega.googlecode.com/git/images/ArduPilotMegaImages/Drawing1.png](http://wiki.ardupilot-mega.googlecode.com/git/images/ArduPilotMegaImages/Drawing1.png)